<?xml version="1.0" encoding="utf-8"?>
<dsql_query number_nodes="2" number_distributions="60" number_distributions_per_node="30">
    <sql>with wscs as   (select sold_date_sk          ,sales_price    from (select ws_sold_date_sk sold_date_sk                ,ws_ext_sales_price sales_price          from web_sales           union all          select cs_sold_date_sk sold_date_sk                ,cs_ext_sales_price sales_price          from catalog_sales) AS s),   wswscs as    (select d_week_seq,          sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,          sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,          sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,          sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,          sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,          sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,          sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales   from wscs       ,date_dim   where d_date_sk = sold_date_sk   group by d_week_seq)   select d_week_seq1         ,round(sun_sales1/sun_sales2,2)         ,round(mon_sales1/mon_sales2,2)         ,round(tue_sales1/tue_sales2,2)         ,round(wed_sales1/wed_sales2,2)         ,round(thu_sales1/thu_sales2,2)         ,round(fri_sales1/fri_sales2,2)         ,round(sat_sales1/sat_sales2,2)   from   (select wswscs.d_week_seq d_week_seq1          ,sun_sales sun_sales1          ,mon_sales mon_sales1          ,tue_sales tue_sales1          ,wed_sales wed_sales1          ,thu_sales thu_sales1          ,fri_sales fri_sales1          ,sat_sales sat_sales1    from wswscs,date_dim     where date_dim.d_week_seq = wswscs.d_week_seq and          d_year = 2001) y,   (select wswscs.d_week_seq d_week_seq2          ,sun_sales sun_sales2          ,mon_sales mon_sales2          ,tue_sales tue_sales2          ,wed_sales wed_sales2          ,thu_sales thu_sales2          ,fri_sales fri_sales2          ,sat_sales sat_sales2    from wswscs        ,date_dim     where date_dim.d_week_seq = wswscs.d_week_seq and          d_year = 2001+1) z   where d_week_seq1=d_week_seq2-53   order by d_week_seq1</sql>
    <dsql_operations total_cost="0.03312" total_number_operations="9">
        <dsql_operation operation_type="RND_ID">
            <identifier>TEMP_ID_124</identifier>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="AllDistributions" />
            <sql_operations>
                <sql_operation type="statement">CREATE TABLE [qtabledb].[dbo].[TEMP_ID_124] ([d_week_seq] INT NOT NULL, [col] DECIMAL(38, 2), [col1] DECIMAL(38, 2), [col2] DECIMAL(38, 2), [col3] DECIMAL(38, 2), [col4] DECIMAL(38, 2), [col5] DECIMAL(38, 2), [col6] DECIMAL(38, 2) ) WITH(DISTRIBUTED_MOVE_FILE='');</sql_operation>
            </sql_operations>
        </dsql_operation>
        <dsql_operation operation_type="SHUFFLE_MOVE">
            <operation_cost cost="0.01608" accumulative_cost="0.01608" average_rowsize="67" output_rows="15" GroupNumber="221" />
            <source_statement>SELECT [T1_1].[d_week_seq] AS [d_week_seq], [T1_1].[col] AS [col], [T1_1].[col1] AS [col1], [T1_1].[col2] AS [col2], [T1_1].[col3] AS [col3], [T1_1].[col4] AS [col4], [T1_1].[col5] AS [col5], [T1_1].[col6] AS [col6] FROM (SELECT SUM(CASE   WHEN ([T2_1].[d_day_name] = CAST (N'Sunday' COLLATE SQL_Latin1_General_CP1_CI_AS AS VARCHAR (6)) COLLATE SQL_Latin1_General_CP1_CI_AS) THEN [T2_2].[ws_ext_sales_price]   ELSE CAST (NULL AS DECIMAL (7, 2))  END) AS [col], SUM(CASE   WHEN ([T2_1].[d_day_name] = CAST (N'Monday' COLLATE SQL_Latin1_General_CP1_CI_AS AS VARCHAR (6)) COLLATE SQL_Latin1_General_CP1_CI_AS) THEN [T2_2].[ws_ext_sales_price]   ELSE CAST (NULL AS DECIMAL (7, 2))  END) AS [col1], SUM(CASE   WHEN ([T2_1].[d_day_name] = CAST (N'Tuesday' COLLATE SQL_Latin1_General_CP1_CI_AS AS VARCHAR (7)) COLLATE SQL_Latin1_General_CP1_CI_AS) THEN [T2_2].[ws_ext_sales_price]   ELSE CAST (NULL AS DECIMAL (7, 2))  END) AS [col2], SUM(CASE   WHEN ([T2_1].[d_day_name] = CAST (N'Wednesday' COLLATE SQL_Latin1_General_CP1_CI_AS AS VARCHAR (9)) COLLATE SQL_Latin1_General_CP1_CI_AS) THEN [T2_2].[ws_ext_sales_price]   ELSE CAST (NULL AS DECIMAL (7, 2))  END) AS [col3], SUM(CASE   WHEN ([T2_1].[d_day_name] = CAST (N'Thursday' COLLATE SQL_Latin1_General_CP1_CI_AS AS VARCHAR (8)) COLLATE SQL_Latin1_General_CP1_CI_AS) THEN [T2_2].[ws_ext_sales_price]   ELSE CAST (NULL AS DECIMAL (7, 2))  END) AS [col4], SUM(CASE   WHEN ([T2_1].[d_day_name] = CAST (N'Friday' COLLATE SQL_Latin1_General_CP1_CI_AS AS VARCHAR (6)) COLLATE SQL_Latin1_General_CP1_CI_AS) THEN [T2_2].[ws_ext_sales_price]   ELSE CAST (NULL AS DECIMAL (7, 2))  END) AS [col5], SUM(CASE   WHEN ([T2_1].[d_day_name] = CAST (N'Saturday' COLLATE SQL_Latin1_General_CP1_CI_AS AS VARCHAR (8)) COLLATE SQL_Latin1_General_CP1_CI_AS) THEN [T2_2].[ws_ext_sales_price]   ELSE CAST (NULL AS DECIMAL (7, 2))  END) AS [col6], [T2_1].[d_week_seq] AS [d_week_seq] FROM (SELECT [T3_1].[d_date_sk] AS [d_date_sk], [T3_1].[d_day_name] AS [d_day_name], [T3_1].[d_week_seq] AS [d_week_seq] FROM [DemoDW].[tpcds].[date_dim] AS T3_1 WHERE ([T3_1].[d_week_seq] IS NOT NULL)) AS T2_1 INNER JOIN  (SELECT [T4_1].[ws_sold_date_sk] AS [ws_sold_date_sk], [T4_1].[ws_ext_sales_price] AS [ws_ext_sales_price] FROM [DemoDW].[tpcds].[web_sales] AS T4_1  UNION ALL  SELECT [T4_1].[cs_sold_date_sk] AS [cs_sold_date_sk], [T4_1].[cs_ext_sales_price] AS [cs_ext_sales_price] FROM [DemoDW].[tpcds].[catalog_sales] AS T4_1) AS T2_2  ON ([T2_2].[ws_sold_date_sk] = [T2_1].[d_date_sk]) GROUP BY [T2_1].[d_week_seq]) AS T1_1  OPTION (MAXDOP 2, MIN_GRANT_PERCENT = [MIN_GRANT], DISTRIBUTED_MOVE(N''))</source_statement>
            <destination_table>[TEMP_ID_124]</destination_table>
            <shuffle_columns>d_week_seq;</shuffle_columns>
        </dsql_operation>
        <dsql_operation operation_type="RND_ID">
            <identifier>TEMP_ID_125</identifier>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="AllDistributions" />
            <sql_operations>
                <sql_operation type="statement">CREATE TABLE [qtabledb].[dbo].[TEMP_ID_125] ([d_week_seq] INT NOT NULL, [col] DECIMAL(38, 2), [col1] DECIMAL(38, 2), [col2] DECIMAL(38, 2), [col3] DECIMAL(38, 2), [col4] DECIMAL(38, 2), [col5] DECIMAL(38, 2), [col6] DECIMAL(38, 2), [col7] INT ) WITH(DISTRIBUTED_MOVE_FILE='');</sql_operation>
            </sql_operations>
        </dsql_operation>
        <dsql_operation operation_type="SHUFFLE_MOVE">
            <operation_cost cost="0.01704" accumulative_cost="0.03312" average_rowsize="71" output_rows="15" GroupNumber="156" />
            <source_statement>SELECT [T1_1].[d_week_seq] AS [d_week_seq], [T1_1].[col] AS [col], [T1_1].[col1] AS [col1], [T1_1].[col2] AS [col2], [T1_1].[col3] AS [col3], [T1_1].[col4] AS [col4], [T1_1].[col5] AS [col5], [T1_1].[col6] AS [col6], [T1_1].[col7] AS [col7] FROM (SELECT SUM([T2_1].[col]) AS [col], SUM([T2_1].[col1]) AS [col1], SUM([T2_1].[col2]) AS [col2], SUM([T2_1].[col3]) AS [col3], SUM([T2_1].[col4]) AS [col4], SUM([T2_1].[col5]) AS [col5], SUM([T2_1].[col6]) AS [col6], ([T2_1].[d_week_seq] - CAST ((53) AS INT)) AS [col7], [T2_1].[d_week_seq] AS [d_week_seq] FROM [qtabledb].[dbo].[TEMP_ID_124] AS T2_1 GROUP BY [T2_1].[d_week_seq]) AS T1_1  OPTION (MAXDOP 2, MIN_GRANT_PERCENT = [MIN_GRANT], DISTRIBUTED_MOVE(N''))</source_statement>
            <destination_table>[TEMP_ID_125]</destination_table>
            <shuffle_columns>col7;</shuffle_columns>
        </dsql_operation>
        <dsql_operation operation_type="RETURN">
            <location distribution="AllDistributions" />
            <select>SELECT [T1_1].[d_week_seq] AS [d_week_seq], [T1_1].[col] AS [col], [T1_1].[col1] AS [col1], [T1_1].[col2] AS [col2], [T1_1].[col3] AS [col3], [T1_1].[col4] AS [col4], [T1_1].[col5] AS [col5], [T1_1].[col6] AS [col6] FROM (SELECT round(([T2_2].[col] / [T2_2].[col1]), CAST ((2) AS INT)) AS [col], round(([T2_2].[col2] / [T2_2].[col13]), CAST ((2) AS INT)) AS [col1], round(([T2_2].[col4] / [T2_2].[col25]), CAST ((2) AS INT)) AS [col2], round(([T2_2].[col6] / [T2_2].[col3]), CAST ((2) AS INT)) AS [col3], round(([T2_2].[col7] / [T2_2].[col48]), CAST ((2) AS INT)) AS [col4], round(([T2_2].[col9] / [T2_2].[col5]), CAST ((2) AS INT)) AS [col5], round(([T2_2].[col10] / [T2_2].[col611]), CAST ((2) AS INT)) AS [col6], [T2_2].[d_week_seq12] AS [d_week_seq] FROM (SELECT [T3_1].[d_week_seq] AS [d_week_seq] FROM [DemoDW].[tpcds].[date_dim] AS T3_1 WHERE (([T3_1].[d_year] = CAST ((2002) AS INT)) AND ([T3_1].[d_week_seq] IS NOT NULL))) AS T2_1 INNER JOIN  (SELECT [T3_1].[d_week_seq] AS [d_week_seq], [T3_2].[col] AS [col], [T3_1].[col] AS [col1], [T3_2].[col1] AS [col2], [T3_1].[col1] AS [col13], [T3_2].[col2] AS [col4], [T3_1].[col2] AS [col25], [T3_2].[col3] AS [col6], [T3_1].[col3] AS [col3], [T3_2].[col4] AS [col7], [T3_1].[col4] AS [col48], [T3_2].[col5] AS [col9], [T3_1].[col5] AS [col5], [T3_2].[col6] AS [col10], [T3_1].[col6] AS [col611], [T3_2].[d_week_seq7] AS [d_week_seq12] FROM [qtabledb].[dbo].[TEMP_ID_125] AS T3_1 INNER JOIN  (SELECT [T4_1].[d_week_seq] AS [d_week_seq], [T4_2].[col] AS [col], [T4_2].[col1] AS [col1], [T4_2].[col2] AS [col2], [T4_2].[col3] AS [col3], [T4_2].[col4] AS [col4], [T4_2].[col5] AS [col5], [T4_2].[col6] AS [col6], [T4_2].[d_week_seq] AS [d_week_seq7] FROM (SELECT [T5_1].[d_week_seq] AS [d_week_seq] FROM [DemoDW].[tpcds].[date_dim] AS T5_1 WHERE (([T5_1].[d_year] = CAST ((2001) AS INT)) AND ([T5_1].[d_week_seq] IS NOT NULL))) AS T4_1 INNER JOIN  (SELECT SUM([T5_1].[col]) AS [col], SUM([T5_1].[col1]) AS [col1], SUM([T5_1].[col2]) AS [col2], SUM([T5_1].[col3]) AS [col3], SUM([T5_1].[col4]) AS [col4], SUM([T5_1].[col5]) AS [col5], SUM([T5_1].[col6]) AS [col6], [T5_1].[d_week_seq] AS [d_week_seq] FROM [qtabledb].[dbo].[TEMP_ID_124] AS T5_1 GROUP BY [T5_1].[d_week_seq]) AS T4_2  ON ([T4_1].[d_week_seq] = [T4_2].[d_week_seq])) AS T3_2  ON ([T3_2].[d_week_seq] = [T3_1].[col7])) AS T2_2  ON ([T2_1].[d_week_seq] = [T2_2].[d_week_seq])) AS T1_1 ORDER BY [T1_1].[d_week_seq] ASC  OPTION (MAXDOP 2, MIN_GRANT_PERCENT = [MIN_GRANT])</select>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="AllDistributions" />
            <sql_operations>
                <sql_operation type="statement">DROP TABLE [qtabledb].[dbo].[TEMP_ID_125]</sql_operation>
            </sql_operations>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="AllDistributions" />
            <sql_operations>
                <sql_operation type="statement">DROP TABLE [qtabledb].[dbo].[TEMP_ID_124]</sql_operation>
            </sql_operations>
        </dsql_operation>
    </dsql_operations>
</dsql_query>
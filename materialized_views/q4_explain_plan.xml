<?xml version="1.0" encoding="utf-8"?>
<dsql_query number_nodes="2" number_distributions="60" number_distributions_per_node="30">
    <sql>with year_total as (   select c_customer_id customer_id         ,c_first_name customer_first_name         ,c_last_name customer_last_name         ,c_preferred_cust_flag customer_preferred_cust_flag         ,c_birth_country customer_birth_country         ,c_login customer_login         ,c_email_address customer_email_address         ,d_year dyear         ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total         ,'s' sale_type   from customer       ,store_sales       ,date_dim   where c_customer_sk = ss_customer_sk     and ss_sold_date_sk = d_date_sk   group by c_customer_id           ,c_first_name           ,c_last_name           ,c_preferred_cust_flag           ,c_birth_country           ,c_login           ,c_email_address           ,d_year   union all   select c_customer_id customer_id         ,c_first_name customer_first_name         ,c_last_name customer_last_name         ,c_preferred_cust_flag customer_preferred_cust_flag         ,c_birth_country customer_birth_country         ,c_login customer_login         ,c_email_address customer_email_address         ,d_year dyear         ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total         ,'c' sale_type   from customer       ,catalog_sales       ,date_dim   where c_customer_sk = cs_bill_customer_sk     and cs_sold_date_sk = d_date_sk   group by c_customer_id           ,c_first_name           ,c_last_name           ,c_preferred_cust_flag           ,c_birth_country           ,c_login           ,c_email_address           ,d_year  union all   select c_customer_id customer_id         ,c_first_name customer_first_name         ,c_last_name customer_last_name         ,c_preferred_cust_flag customer_preferred_cust_flag         ,c_birth_country customer_birth_country         ,c_login customer_login         ,c_email_address customer_email_address         ,d_year dyear         ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total         ,'w' sale_type   from customer       ,web_sales       ,date_dim   where c_customer_sk = ws_bill_customer_sk     and ws_sold_date_sk = d_date_sk   group by c_customer_id           ,c_first_name           ,c_last_name           ,c_preferred_cust_flag           ,c_birth_country           ,c_login           ,c_email_address           ,d_year           )    select top 100                     t_s_secyear.customer_id                   ,t_s_secyear.customer_first_name                   ,t_s_secyear.customer_last_name                   ,t_s_secyear.customer_email_address   from year_total t_s_firstyear       ,year_total t_s_secyear       ,year_total t_c_firstyear       ,year_total t_c_secyear       ,year_total t_w_firstyear       ,year_total t_w_secyear   where t_s_secyear.customer_id = t_s_firstyear.customer_id     and t_s_firstyear.customer_id = t_c_secyear.customer_id     and t_s_firstyear.customer_id = t_c_firstyear.customer_id     and t_s_firstyear.customer_id = t_w_firstyear.customer_id     and t_s_firstyear.customer_id = t_w_secyear.customer_id     and t_s_firstyear.sale_type = 's'     and t_c_firstyear.sale_type = 'c'     and t_w_firstyear.sale_type = 'w'     and t_s_secyear.sale_type = 's'     and t_c_secyear.sale_type = 'c'     and t_w_secyear.sale_type = 'w'     and t_s_firstyear.dyear =  2001     and t_s_secyear.dyear = 2001+1     and t_c_firstyear.dyear =  2001     and t_c_secyear.dyear =  2001+1     and t_w_firstyear.dyear = 2001     and t_w_secyear.dyear = 2001+1     and t_s_firstyear.year_total &gt; 0     and t_c_firstyear.year_total &gt; 0     and t_w_firstyear.year_total &gt; 0     and case when t_c_firstyear.year_total &gt; 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end             &gt; case when t_s_firstyear.year_total &gt; 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end     and case when t_c_firstyear.year_total &gt; 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end             &gt; case when t_w_firstyear.year_total &gt; 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end   order by t_s_secyear.customer_id           ,t_s_secyear.customer_first_name           ,t_s_secyear.customer_last_name           ,t_s_secyear.customer_email_address</sql>
    <materialized_view_candidates>
        <materialized_view_candidates with_constants="False">CREATE MATERIALIZED VIEW View1 WITH (DISTRIBUTION = HASH([Expr0])) AS  SELECT [DemoDW].[tpcds].[customer].[c_customer_id] AS [Expr0],         [DemoDW].[tpcds].[customer].[c_first_name] AS [Expr1],         [DemoDW].[tpcds].[customer].[c_last_name] AS [Expr2],         [DemoDW].[tpcds].[customer].[c_preferred_cust_flag] AS [Expr3],         [DemoDW].[tpcds].[customer].[c_birth_country] AS [Expr4],         [DemoDW].[tpcds].[customer].[c_login] AS [Expr5],         [DemoDW].[tpcds].[customer].[c_email_address] AS [Expr6],         [DemoDW].[tpcds].[date_dim].[d_year] AS [Expr7],         SUM(([DemoDW].[tpcds].[web_sales].[ws_ext_list_price]-[DemoDW].[tpcds].[web_sales].[ws_ext_wholesale_cost]-[DemoDW].[tpcds].[web_sales].[ws_ext_discount_amt]+[DemoDW].[tpcds].[web_sales].[ws_ext_sales_price])/(2.)) AS [Expr8],         COUNT_BIG(([DemoDW].[tpcds].[web_sales].[ws_ext_list_price]-[DemoDW].[tpcds].[web_sales].[ws_ext_wholesale_cost]-[DemoDW].[tpcds].[web_sales].[ws_ext_discount_amt]+[DemoDW].[tpcds].[web_sales].[ws_ext_sales_price])/(2.)) AS [Expr9]  FROM [tpcds].[web_sales],       [tpcds].[customer],       [tpcds].[date_dim]  WHERE ([DemoDW].[tpcds].[web_sales].[ws_sold_date_sk]=[DemoDW].[tpcds].[date_dim].[d_date_sk])    AND ([DemoDW].[tpcds].[customer].[c_customer_sk]=[DemoDW].[tpcds].[web_sales].[ws_bill_customer_sk])  GROUP BY [DemoDW].[tpcds].[customer].[c_customer_id],           [DemoDW].[tpcds].[customer].[c_first_name],           [DemoDW].[tpcds].[customer].[c_last_name],           [DemoDW].[tpcds].[customer].[c_preferred_cust_flag],           [DemoDW].[tpcds].[customer].[c_birth_country],           [DemoDW].[tpcds].[customer].[c_login],           [DemoDW].[tpcds].[customer].[c_email_address],           [DemoDW].[tpcds].[date_dim].[d_year]</materialized_view_candidates>
        <materialized_view_candidates with_constants="False">CREATE MATERIALIZED VIEW View2 WITH (DISTRIBUTION = HASH([Expr0])) AS  SELECT [DemoDW].[tpcds].[customer].[c_customer_id] AS [Expr0],         [DemoDW].[tpcds].[customer].[c_first_name] AS [Expr1],         [DemoDW].[tpcds].[customer].[c_last_name] AS [Expr2],         [DemoDW].[tpcds].[customer].[c_preferred_cust_flag] AS [Expr3],         [DemoDW].[tpcds].[customer].[c_birth_country] AS [Expr4],         [DemoDW].[tpcds].[customer].[c_login] AS [Expr5],         [DemoDW].[tpcds].[customer].[c_email_address] AS [Expr6],         [DemoDW].[tpcds].[date_dim].[d_year] AS [Expr7],         SUM(([DemoDW].[tpcds].[catalog_sales].[cs_ext_list_price]-[DemoDW].[tpcds].[catalog_sales].[cs_ext_wholesale_cost]-[DemoDW].[tpcds].[catalog_sales].[cs_ext_discount_amt]+[DemoDW].[tpcds].[catalog_sales].[cs_ext_sales_price])/(2.)) AS [Expr8],         COUNT_BIG(([DemoDW].[tpcds].[catalog_sales].[cs_ext_list_price]-[DemoDW].[tpcds].[catalog_sales].[cs_ext_wholesale_cost]-[DemoDW].[tpcds].[catalog_sales].[cs_ext_discount_amt]+[DemoDW].[tpcds].[catalog_sales].[cs_ext_sales_price])/(2.)) AS [Expr9]  FROM [tpcds].[catalog_sales],       [tpcds].[customer],       [tpcds].[date_dim]  WHERE ([DemoDW].[tpcds].[catalog_sales].[cs_sold_date_sk]=[DemoDW].[tpcds].[date_dim].[d_date_sk])    AND ([DemoDW].[tpcds].[customer].[c_customer_sk]=[DemoDW].[tpcds].[catalog_sales].[cs_bill_customer_sk])  GROUP BY [DemoDW].[tpcds].[customer].[c_customer_id],           [DemoDW].[tpcds].[customer].[c_first_name],           [DemoDW].[tpcds].[customer].[c_last_name],           [DemoDW].[tpcds].[customer].[c_preferred_cust_flag],           [DemoDW].[tpcds].[customer].[c_birth_country],           [DemoDW].[tpcds].[customer].[c_login],           [DemoDW].[tpcds].[customer].[c_email_address],           [DemoDW].[tpcds].[date_dim].[d_year]</materialized_view_candidates>
        <materialized_view_candidates with_constants="False">CREATE MATERIALIZED VIEW View3 WITH (DISTRIBUTION = HASH([Expr0])) AS  SELECT [DemoDW].[tpcds].[customer].[c_customer_id] AS [Expr0],         [DemoDW].[tpcds].[customer].[c_first_name] AS [Expr1],         [DemoDW].[tpcds].[customer].[c_last_name] AS [Expr2],         [DemoDW].[tpcds].[customer].[c_preferred_cust_flag] AS [Expr3],         [DemoDW].[tpcds].[customer].[c_birth_country] AS [Expr4],         [DemoDW].[tpcds].[customer].[c_login] AS [Expr5],         [DemoDW].[tpcds].[customer].[c_email_address] AS [Expr6],         [DemoDW].[tpcds].[date_dim].[d_year] AS [Expr7],         SUM(([DemoDW].[tpcds].[store_sales].[ss_ext_list_price]-[DemoDW].[tpcds].[store_sales].[ss_ext_wholesale_cost]-[DemoDW].[tpcds].[store_sales].[ss_ext_discount_amt]+[DemoDW].[tpcds].[store_sales].[ss_ext_sales_price])/(2.)) AS [Expr8],         COUNT_BIG(([DemoDW].[tpcds].[store_sales].[ss_ext_list_price]-[DemoDW].[tpcds].[store_sales].[ss_ext_wholesale_cost]-[DemoDW].[tpcds].[store_sales].[ss_ext_discount_amt]+[DemoDW].[tpcds].[store_sales].[ss_ext_sales_price])/(2.)) AS [Expr9]  FROM [tpcds].[store_sales],       [tpcds].[customer],       [tpcds].[date_dim]  WHERE ([DemoDW].[tpcds].[store_sales].[ss_sold_date_sk]=[DemoDW].[tpcds].[date_dim].[d_date_sk])    AND ([DemoDW].[tpcds].[customer].[c_customer_sk]=[DemoDW].[tpcds].[store_sales].[ss_customer_sk])  GROUP BY [DemoDW].[tpcds].[customer].[c_customer_id],           [DemoDW].[tpcds].[customer].[c_first_name],           [DemoDW].[tpcds].[customer].[c_last_name],           [DemoDW].[tpcds].[customer].[c_preferred_cust_flag],           [DemoDW].[tpcds].[customer].[c_birth_country],           [DemoDW].[tpcds].[customer].[c_login],           [DemoDW].[tpcds].[customer].[c_email_address],           [DemoDW].[tpcds].[date_dim].[d_year]</materialized_view_candidates>
        <materialized_view_candidates with_constants="False">CREATE MATERIALIZED VIEW View4 WITH (DISTRIBUTION = HASH([Expr0])) AS  SELECT [DemoDW].[tpcds].[customer].[c_customer_id] AS [Expr0],         [DemoDW].[tpcds].[customer].[c_first_name] AS [Expr1],         [DemoDW].[tpcds].[customer].[c_last_name] AS [Expr2],         [DemoDW].[tpcds].[customer].[c_preferred_cust_flag] AS [Expr3],         [DemoDW].[tpcds].[customer].[c_birth_country] AS [Expr4],         [DemoDW].[tpcds].[customer].[c_login] AS [Expr5],         [DemoDW].[tpcds].[customer].[c_email_address] AS [Expr6],         [DemoDW].[tpcds].[date_dim].[d_year] AS [Expr7],         [DemoDW].[tpcds].[store_sales].[ss_ext_discount_amt] AS [Expr8],         [DemoDW].[tpcds].[store_sales].[ss_ext_sales_price] AS [Expr9],         [DemoDW].[tpcds].[store_sales].[ss_ext_wholesale_cost] AS [Expr10],         [DemoDW].[tpcds].[store_sales].[ss_ext_list_price] AS [Expr11],         SUM(([DemoDW].[tpcds].[store_sales].[ss_ext_list_price]-[DemoDW].[tpcds].[store_sales].[ss_ext_wholesale_cost]-[DemoDW].[tpcds].[store_sales].[ss_ext_discount_amt]+[DemoDW].[tpcds].[store_sales].[ss_ext_sales_price])/(2.)) AS [Expr12],         COUNT_BIG(([DemoDW].[tpcds].[store_sales].[ss_ext_list_price]-[DemoDW].[tpcds].[store_sales].[ss_ext_wholesale_cost]-[DemoDW].[tpcds].[store_sales].[ss_ext_discount_amt]+[DemoDW].[tpcds].[store_sales].[ss_ext_sales_price])/(2.)) AS [Expr13]  FROM [tpcds].[store_sales],       [tpcds].[customer],       [tpcds].[date_dim]  WHERE ([DemoDW].[tpcds].[store_sales].[ss_sold_date_sk]=[DemoDW].[tpcds].[date_dim].[d_date_sk])    AND ([DemoDW].[tpcds].[customer].[c_customer_sk]=[DemoDW].[tpcds].[store_sales].[ss_customer_sk])  GROUP BY [DemoDW].[tpcds].[customer].[c_customer_id],           [DemoDW].[tpcds].[customer].[c_first_name],           [DemoDW].[tpcds].[customer].[c_last_name],           [DemoDW].[tpcds].[customer].[c_preferred_cust_flag],           [DemoDW].[tpcds].[customer].[c_birth_country],           [DemoDW].[tpcds].[customer].[c_login],           [DemoDW].[tpcds].[customer].[c_email_address],           [DemoDW].[tpcds].[date_dim].[d_year],           [DemoDW].[tpcds].[store_sales].[ss_ext_discount_amt],           [DemoDW].[tpcds].[store_sales].[ss_ext_sales_price],           [DemoDW].[tpcds].[store_sales].[ss_ext_wholesale_cost],           [DemoDW].[tpcds].[store_sales].[ss_ext_list_price]</materialized_view_candidates>
        <materialized_view_candidates with_constants="False">CREATE MATERIALIZED VIEW View5 WITH (DISTRIBUTION = HASH([Expr0])) AS  SELECT [DemoDW].[tpcds].[customer].[c_customer_id] AS [Expr0],         [DemoDW].[tpcds].[customer].[c_first_name] AS [Expr1],         [DemoDW].[tpcds].[customer].[c_last_name] AS [Expr2],         [DemoDW].[tpcds].[customer].[c_preferred_cust_flag] AS [Expr3],         [DemoDW].[tpcds].[customer].[c_birth_country] AS [Expr4],         [DemoDW].[tpcds].[customer].[c_login] AS [Expr5],         [DemoDW].[tpcds].[customer].[c_email_address] AS [Expr6],         [DemoDW].[tpcds].[date_dim].[d_year] AS [Expr7],         [DemoDW].[tpcds].[catalog_sales].[cs_ext_discount_amt] AS [Expr8],         [DemoDW].[tpcds].[catalog_sales].[cs_ext_sales_price] AS [Expr9],         [DemoDW].[tpcds].[catalog_sales].[cs_ext_wholesale_cost] AS [Expr10],         [DemoDW].[tpcds].[catalog_sales].[cs_ext_list_price] AS [Expr11],         SUM(([DemoDW].[tpcds].[catalog_sales].[cs_ext_list_price]-[DemoDW].[tpcds].[catalog_sales].[cs_ext_wholesale_cost]-[DemoDW].[tpcds].[catalog_sales].[cs_ext_discount_amt]+[DemoDW].[tpcds].[catalog_sales].[cs_ext_sales_price])/(2.)) AS [Expr12],         COUNT_BIG(([DemoDW].[tpcds].[catalog_sales].[cs_ext_list_price]-[DemoDW].[tpcds].[catalog_sales].[cs_ext_wholesale_cost]-[DemoDW].[tpcds].[catalog_sales].[cs_ext_discount_amt]+[DemoDW].[tpcds].[catalog_sales].[cs_ext_sales_price])/(2.)) AS [Expr13]  FROM [tpcds].[catalog_sales],       [tpcds].[customer],       [tpcds].[date_dim]  WHERE ([DemoDW].[tpcds].[catalog_sales].[cs_sold_date_sk]=[DemoDW].[tpcds].[date_dim].[d_date_sk])    AND ([DemoDW].[tpcds].[customer].[c_customer_sk]=[DemoDW].[tpcds].[catalog_sales].[cs_bill_customer_sk])  GROUP BY [DemoDW].[tpcds].[customer].[c_customer_id],           [DemoDW].[tpcds].[customer].[c_first_name],           [DemoDW].[tpcds].[customer].[c_last_name],           [DemoDW].[tpcds].[customer].[c_preferred_cust_flag],           [DemoDW].[tpcds].[customer].[c_birth_country],           [DemoDW].[tpcds].[customer].[c_login],           [DemoDW].[tpcds].[customer].[c_email_address],           [DemoDW].[tpcds].[date_dim].[d_year],           [DemoDW].[tpcds].[catalog_sales].[cs_ext_discount_amt],           [DemoDW].[tpcds].[catalog_sales].[cs_ext_sales_price],           [DemoDW].[tpcds].[catalog_sales].[cs_ext_wholesale_cost],           [DemoDW].[tpcds].[catalog_sales].[cs_ext_list_price]</materialized_view_candidates>
        <materialized_view_candidates with_constants="False">CREATE MATERIALIZED VIEW View6 WITH (DISTRIBUTION = HASH([Expr0])) AS  SELECT [DemoDW].[tpcds].[customer].[c_customer_id] AS [Expr0],         [DemoDW].[tpcds].[customer].[c_first_name] AS [Expr1],         [DemoDW].[tpcds].[customer].[c_last_name] AS [Expr2],         [DemoDW].[tpcds].[customer].[c_preferred_cust_flag] AS [Expr3],         [DemoDW].[tpcds].[customer].[c_birth_country] AS [Expr4],         [DemoDW].[tpcds].[customer].[c_login] AS [Expr5],         [DemoDW].[tpcds].[customer].[c_email_address] AS [Expr6],         [DemoDW].[tpcds].[date_dim].[d_year] AS [Expr7],         [DemoDW].[tpcds].[web_sales].[ws_ext_discount_amt] AS [Expr8],         [DemoDW].[tpcds].[web_sales].[ws_ext_sales_price] AS [Expr9],         [DemoDW].[tpcds].[web_sales].[ws_ext_wholesale_cost] AS [Expr10],         [DemoDW].[tpcds].[web_sales].[ws_ext_list_price] AS [Expr11],         SUM(([DemoDW].[tpcds].[web_sales].[ws_ext_list_price]-[DemoDW].[tpcds].[web_sales].[ws_ext_wholesale_cost]-[DemoDW].[tpcds].[web_sales].[ws_ext_discount_amt]+[DemoDW].[tpcds].[web_sales].[ws_ext_sales_price])/(2.)) AS [Expr12],         COUNT_BIG(([DemoDW].[tpcds].[web_sales].[ws_ext_list_price]-[DemoDW].[tpcds].[web_sales].[ws_ext_wholesale_cost]-[DemoDW].[tpcds].[web_sales].[ws_ext_discount_amt]+[DemoDW].[tpcds].[web_sales].[ws_ext_sales_price])/(2.)) AS [Expr13]  FROM [tpcds].[web_sales],       [tpcds].[customer],       [tpcds].[date_dim]  WHERE ([DemoDW].[tpcds].[web_sales].[ws_sold_date_sk]=[DemoDW].[tpcds].[date_dim].[d_date_sk])    AND ([DemoDW].[tpcds].[customer].[c_customer_sk]=[DemoDW].[tpcds].[web_sales].[ws_bill_customer_sk])  GROUP BY [DemoDW].[tpcds].[customer].[c_customer_id],           [DemoDW].[tpcds].[customer].[c_first_name],           [DemoDW].[tpcds].[customer].[c_last_name],           [DemoDW].[tpcds].[customer].[c_preferred_cust_flag],           [DemoDW].[tpcds].[customer].[c_birth_country],           [DemoDW].[tpcds].[customer].[c_login],           [DemoDW].[tpcds].[customer].[c_email_address],           [DemoDW].[tpcds].[date_dim].[d_year],           [DemoDW].[tpcds].[web_sales].[ws_ext_discount_amt],           [DemoDW].[tpcds].[web_sales].[ws_ext_sales_price],           [DemoDW].[tpcds].[web_sales].[ws_ext_wholesale_cost],           [DemoDW].[tpcds].[web_sales].[ws_ext_list_price]</materialized_view_candidates>
        <materialized_view_candidates with_constants="True">CREATE MATERIALIZED VIEW View7 WITH (DISTRIBUTION = HASH([Expr0])) AS  SELECT [DemoDW].[tpcds].[customer].[c_customer_id] AS [Expr0],         [DemoDW].[tpcds].[customer].[c_first_name] AS [Expr1],         [DemoDW].[tpcds].[customer].[c_last_name] AS [Expr2],         [DemoDW].[tpcds].[customer].[c_preferred_cust_flag] AS [Expr3],         [DemoDW].[tpcds].[customer].[c_birth_country] AS [Expr4],         [DemoDW].[tpcds].[customer].[c_login] AS [Expr5],         [DemoDW].[tpcds].[customer].[c_email_address] AS [Expr6],         SUM(([DemoDW].[tpcds].[web_sales].[ws_ext_list_price]-[DemoDW].[tpcds].[web_sales].[ws_ext_wholesale_cost]-[DemoDW].[tpcds].[web_sales].[ws_ext_discount_amt]+[DemoDW].[tpcds].[web_sales].[ws_ext_sales_price])/(2.)) AS [Expr7],         COUNT_BIG(([DemoDW].[tpcds].[web_sales].[ws_ext_list_price]-[DemoDW].[tpcds].[web_sales].[ws_ext_wholesale_cost]-[DemoDW].[tpcds].[web_sales].[ws_ext_discount_amt]+[DemoDW].[tpcds].[web_sales].[ws_ext_sales_price])/(2.)) AS [Expr8]  FROM [tpcds].[web_sales],       [tpcds].[customer],       [tpcds].[date_dim]  WHERE ([DemoDW].[tpcds].[web_sales].[ws_sold_date_sk]=[DemoDW].[tpcds].[date_dim].[d_date_sk])    AND ([DemoDW].[tpcds].[customer].[c_customer_sk]=[DemoDW].[tpcds].[web_sales].[ws_bill_customer_sk])    AND ([DemoDW].[tpcds].[date_dim].[d_year]=(2002))  GROUP BY [DemoDW].[tpcds].[customer].[c_customer_id],           [DemoDW].[tpcds].[customer].[c_first_name],           [DemoDW].[tpcds].[customer].[c_last_name],           [DemoDW].[tpcds].[customer].[c_preferred_cust_flag],           [DemoDW].[tpcds].[customer].[c_birth_country],           [DemoDW].[tpcds].[customer].[c_login],           [DemoDW].[tpcds].[customer].[c_email_address]</materialized_view_candidates>
        <materialized_view_candidates with_constants="True">CREATE MATERIALIZED VIEW View8 WITH (DISTRIBUTION = HASH([Expr0])) AS  SELECT [DemoDW].[tpcds].[customer].[c_customer_id] AS [Expr0],         [DemoDW].[tpcds].[customer].[c_first_name] AS [Expr1],         [DemoDW].[tpcds].[customer].[c_last_name] AS [Expr2],         [DemoDW].[tpcds].[customer].[c_preferred_cust_flag] AS [Expr3],         [DemoDW].[tpcds].[customer].[c_birth_country] AS [Expr4],         [DemoDW].[tpcds].[customer].[c_login] AS [Expr5],         [DemoDW].[tpcds].[customer].[c_email_address] AS [Expr6],         SUM(([DemoDW].[tpcds].[catalog_sales].[cs_ext_list_price]-[DemoDW].[tpcds].[catalog_sales].[cs_ext_wholesale_cost]-[DemoDW].[tpcds].[catalog_sales].[cs_ext_discount_amt]+[DemoDW].[tpcds].[catalog_sales].[cs_ext_sales_price])/(2.)) AS [Expr7],         COUNT_BIG(([DemoDW].[tpcds].[catalog_sales].[cs_ext_list_price]-[DemoDW].[tpcds].[catalog_sales].[cs_ext_wholesale_cost]-[DemoDW].[tpcds].[catalog_sales].[cs_ext_discount_amt]+[DemoDW].[tpcds].[catalog_sales].[cs_ext_sales_price])/(2.)) AS [Expr8]  FROM [tpcds].[catalog_sales],       [tpcds].[customer],       [tpcds].[date_dim]  WHERE ([DemoDW].[tpcds].[catalog_sales].[cs_sold_date_sk]=[DemoDW].[tpcds].[date_dim].[d_date_sk])    AND ([DemoDW].[tpcds].[customer].[c_customer_sk]=[DemoDW].[tpcds].[catalog_sales].[cs_bill_customer_sk])    AND ([DemoDW].[tpcds].[date_dim].[d_year]=(2002))  GROUP BY [DemoDW].[tpcds].[customer].[c_customer_id],           [DemoDW].[tpcds].[customer].[c_first_name],           [DemoDW].[tpcds].[customer].[c_last_name],           [DemoDW].[tpcds].[customer].[c_preferred_cust_flag],           [DemoDW].[tpcds].[customer].[c_birth_country],           [DemoDW].[tpcds].[customer].[c_login],           [DemoDW].[tpcds].[customer].[c_email_address]</materialized_view_candidates>
        <materialized_view_candidates with_constants="True">CREATE MATERIALIZED VIEW View9 WITH (DISTRIBUTION = HASH([Expr0])) AS  SELECT [DemoDW].[tpcds].[customer].[c_customer_id] AS [Expr0],         [DemoDW].[tpcds].[customer].[c_first_name] AS [Expr1],         [DemoDW].[tpcds].[customer].[c_last_name] AS [Expr2],         [DemoDW].[tpcds].[customer].[c_preferred_cust_flag] AS [Expr3],         [DemoDW].[tpcds].[customer].[c_birth_country] AS [Expr4],         [DemoDW].[tpcds].[customer].[c_login] AS [Expr5],         [DemoDW].[tpcds].[customer].[c_email_address] AS [Expr6],         SUM(([DemoDW].[tpcds].[store_sales].[ss_ext_list_price]-[DemoDW].[tpcds].[store_sales].[ss_ext_wholesale_cost]-[DemoDW].[tpcds].[store_sales].[ss_ext_discount_amt]+[DemoDW].[tpcds].[store_sales].[ss_ext_sales_price])/(2.)) AS [Expr7],         COUNT_BIG(([DemoDW].[tpcds].[store_sales].[ss_ext_list_price]-[DemoDW].[tpcds].[store_sales].[ss_ext_wholesale_cost]-[DemoDW].[tpcds].[store_sales].[ss_ext_discount_amt]+[DemoDW].[tpcds].[store_sales].[ss_ext_sales_price])/(2.)) AS [Expr8]  FROM [tpcds].[store_sales],       [tpcds].[customer],       [tpcds].[date_dim]  WHERE ([DemoDW].[tpcds].[store_sales].[ss_sold_date_sk]=[DemoDW].[tpcds].[date_dim].[d_date_sk])    AND ([DemoDW].[tpcds].[customer].[c_customer_sk]=[DemoDW].[tpcds].[store_sales].[ss_customer_sk])    AND ([DemoDW].[tpcds].[date_dim].[d_year]=(2002))  GROUP BY [DemoDW].[tpcds].[customer].[c_customer_id],           [DemoDW].[tpcds].[customer].[c_first_name],           [DemoDW].[tpcds].[customer].[c_last_name],           [DemoDW].[tpcds].[customer].[c_preferred_cust_flag],           [DemoDW].[tpcds].[customer].[c_birth_country],           [DemoDW].[tpcds].[customer].[c_login],           [DemoDW].[tpcds].[customer].[c_email_address]</materialized_view_candidates>
        <materialized_view_candidates with_constants="True">CREATE MATERIALIZED VIEW View10 WITH (DISTRIBUTION = HASH([Expr0])) AS  SELECT [DemoDW].[tpcds].[customer].[c_customer_id] AS [Expr0],         [DemoDW].[tpcds].[customer].[c_first_name] AS [Expr1],         [DemoDW].[tpcds].[customer].[c_last_name] AS [Expr2],         [DemoDW].[tpcds].[customer].[c_preferred_cust_flag] AS [Expr3],         [DemoDW].[tpcds].[customer].[c_birth_country] AS [Expr4],         [DemoDW].[tpcds].[customer].[c_login] AS [Expr5],         [DemoDW].[tpcds].[customer].[c_email_address] AS [Expr6],         SUM(([DemoDW].[tpcds].[store_sales].[ss_ext_list_price]-[DemoDW].[tpcds].[store_sales].[ss_ext_wholesale_cost]-[DemoDW].[tpcds].[store_sales].[ss_ext_discount_amt]+[DemoDW].[tpcds].[store_sales].[ss_ext_sales_price])/(2.)) AS [Expr7]  FROM [tpcds].[store_sales],       [tpcds].[customer],       [tpcds].[date_dim]  WHERE ([DemoDW].[tpcds].[store_sales].[ss_sold_date_sk]=[DemoDW].[tpcds].[date_dim].[d_date_sk])    AND ([DemoDW].[tpcds].[customer].[c_customer_sk]=[DemoDW].[tpcds].[store_sales].[ss_customer_sk])    AND ([DemoDW].[tpcds].[date_dim].[d_year]=(2001))    AND ([DemoDW].[tpcds].[store_sales].[ss_ext_discount_amt] IS NOT NULL)    AND ([DemoDW].[tpcds].[store_sales].[ss_ext_sales_price] IS NOT NULL)    AND ([DemoDW].[tpcds].[store_sales].[ss_ext_wholesale_cost] IS NOT NULL)    AND ([DemoDW].[tpcds].[store_sales].[ss_ext_list_price] IS NOT NULL)  GROUP BY [DemoDW].[tpcds].[customer].[c_customer_id],           [DemoDW].[tpcds].[customer].[c_first_name],           [DemoDW].[tpcds].[customer].[c_last_name],           [DemoDW].[tpcds].[customer].[c_preferred_cust_flag],           [DemoDW].[tpcds].[customer].[c_birth_country],           [DemoDW].[tpcds].[customer].[c_login],           [DemoDW].[tpcds].[customer].[c_email_address]</materialized_view_candidates>
        <materialized_view_candidates with_constants="True">CREATE MATERIALIZED VIEW View11 WITH (DISTRIBUTION = HASH([Expr0])) AS  SELECT [DemoDW].[tpcds].[customer].[c_customer_id] AS [Expr0],         [DemoDW].[tpcds].[customer].[c_first_name] AS [Expr1],         [DemoDW].[tpcds].[customer].[c_last_name] AS [Expr2],         [DemoDW].[tpcds].[customer].[c_preferred_cust_flag] AS [Expr3],         [DemoDW].[tpcds].[customer].[c_birth_country] AS [Expr4],         [DemoDW].[tpcds].[customer].[c_login] AS [Expr5],         [DemoDW].[tpcds].[customer].[c_email_address] AS [Expr6],         SUM(([DemoDW].[tpcds].[catalog_sales].[cs_ext_list_price]-[DemoDW].[tpcds].[catalog_sales].[cs_ext_wholesale_cost]-[DemoDW].[tpcds].[catalog_sales].[cs_ext_discount_amt]+[DemoDW].[tpcds].[catalog_sales].[cs_ext_sales_price])/(2.)) AS [Expr7]  FROM [tpcds].[catalog_sales],       [tpcds].[customer],       [tpcds].[date_dim]  WHERE ([DemoDW].[tpcds].[catalog_sales].[cs_sold_date_sk]=[DemoDW].[tpcds].[date_dim].[d_date_sk])    AND ([DemoDW].[tpcds].[customer].[c_customer_sk]=[DemoDW].[tpcds].[catalog_sales].[cs_bill_customer_sk])    AND ([DemoDW].[tpcds].[date_dim].[d_year]=(2001))    AND ([DemoDW].[tpcds].[catalog_sales].[cs_ext_discount_amt] IS NOT NULL)    AND ([DemoDW].[tpcds].[catalog_sales].[cs_ext_sales_price] IS NOT NULL)    AND ([DemoDW].[tpcds].[catalog_sales].[cs_ext_wholesale_cost] IS NOT NULL)    AND ([DemoDW].[tpcds].[catalog_sales].[cs_ext_list_price] IS NOT NULL)  GROUP BY [DemoDW].[tpcds].[customer].[c_customer_id],           [DemoDW].[tpcds].[customer].[c_first_name],           [DemoDW].[tpcds].[customer].[c_last_name],           [DemoDW].[tpcds].[customer].[c_preferred_cust_flag],           [DemoDW].[tpcds].[customer].[c_birth_country],           [DemoDW].[tpcds].[customer].[c_login],           [DemoDW].[tpcds].[customer].[c_email_address]</materialized_view_candidates>
        <materialized_view_candidates with_constants="True">CREATE MATERIALIZED VIEW View12 WITH (DISTRIBUTION = HASH([Expr0])) AS  SELECT [DemoDW].[tpcds].[customer].[c_customer_id] AS [Expr0],         [DemoDW].[tpcds].[customer].[c_first_name] AS [Expr1],         [DemoDW].[tpcds].[customer].[c_last_name] AS [Expr2],         [DemoDW].[tpcds].[customer].[c_preferred_cust_flag] AS [Expr3],         [DemoDW].[tpcds].[customer].[c_birth_country] AS [Expr4],         [DemoDW].[tpcds].[customer].[c_login] AS [Expr5],         [DemoDW].[tpcds].[customer].[c_email_address] AS [Expr6],         SUM(([DemoDW].[tpcds].[web_sales].[ws_ext_list_price]-[DemoDW].[tpcds].[web_sales].[ws_ext_wholesale_cost]-[DemoDW].[tpcds].[web_sales].[ws_ext_discount_amt]+[DemoDW].[tpcds].[web_sales].[ws_ext_sales_price])/(2.)) AS [Expr7]  FROM [tpcds].[web_sales],       [tpcds].[customer],       [tpcds].[date_dim]  WHERE ([DemoDW].[tpcds].[web_sales].[ws_sold_date_sk]=[DemoDW].[tpcds].[date_dim].[d_date_sk])    AND ([DemoDW].[tpcds].[customer].[c_customer_sk]=[DemoDW].[tpcds].[web_sales].[ws_bill_customer_sk])    AND ([DemoDW].[tpcds].[date_dim].[d_year]=(2001))    AND ([DemoDW].[tpcds].[web_sales].[ws_ext_discount_amt] IS NOT NULL)    AND ([DemoDW].[tpcds].[web_sales].[ws_ext_sales_price] IS NOT NULL)    AND ([DemoDW].[tpcds].[web_sales].[ws_ext_wholesale_cost] IS NOT NULL)    AND ([DemoDW].[tpcds].[web_sales].[ws_ext_list_price] IS NOT NULL)  GROUP BY [DemoDW].[tpcds].[customer].[c_customer_id],           [DemoDW].[tpcds].[customer].[c_first_name],           [DemoDW].[tpcds].[customer].[c_last_name],           [DemoDW].[tpcds].[customer].[c_preferred_cust_flag],           [DemoDW].[tpcds].[customer].[c_birth_country],           [DemoDW].[tpcds].[customer].[c_login],           [DemoDW].[tpcds].[customer].[c_email_address]</materialized_view_candidates>
    </materialized_view_candidates>
    <dsql_operations total_cost="5.63157885559322" total_number_operations="28">
        <dsql_operation operation_type="RND_ID">
            <identifier>TEMP_ID_158</identifier>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="AllDistributions" />
            <sql_operations>
                <sql_operation type="statement">CREATE TABLE [qtabledb].[dbo].[TEMP_ID_158] ([c_customer_id] CHAR(16) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL, [c_first_name] CHAR(20) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_last_name] CHAR(30) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_preferred_cust_flag] CHAR(1) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_birth_country] VARCHAR(20) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_login] CHAR(13) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_email_address] CHAR(50) COLLATE SQL_Latin1_General_CP1_CI_AS, [col] DECIMAL(38, 6) ) WITH(DISTRIBUTED_MOVE_FILE='');</sql_operation>
            </sql_operations>
        </dsql_operation>
        <dsql_operation operation_type="SHUFFLE_MOVE">
            <operation_cost cost="0.612800444745763" accumulative_cost="0.612800444745763" average_rowsize="159" output_rows="473.732" GroupNumber="479" />
            <source_statement>SELECT [T1_1].[c_customer_id] AS [c_customer_id], [T1_1].[c_first_name] AS [c_first_name], [T1_1].[c_last_name] AS [c_last_name], [T1_1].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T1_1].[c_birth_country] AS [c_birth_country], [T1_1].[c_login] AS [c_login], [T1_1].[c_email_address] AS [c_email_address], [T1_1].[col] AS [col] FROM (SELECT SUM([T2_2].[col]) AS [col], [T2_2].[c_customer_id] AS [c_customer_id], [T2_2].[c_first_name] AS [c_first_name], [T2_2].[c_last_name] AS [c_last_name], [T2_2].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T2_2].[c_birth_country] AS [c_birth_country], [T2_2].[c_login] AS [c_login], [T2_2].[c_email_address] AS [c_email_address] FROM (SELECT [T3_1].[d_date_sk] AS [d_date_sk] FROM [DemoDW].[tpcds].[date_dim] AS T3_1 WHERE ([T3_1].[d_year] = CAST ((2001) AS INT))) AS T2_1 INNER JOIN  (SELECT [T3_2].[ss_sold_date_sk] AS [ss_sold_date_sk], [T3_2].[col] AS [col], [T3_1].[c_customer_id] AS [c_customer_id], [T3_1].[c_first_name] AS [c_first_name], [T3_1].[c_last_name] AS [c_last_name], [T3_1].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T3_1].[c_birth_country] AS [c_birth_country], [T3_1].[c_login] AS [c_login], [T3_1].[c_email_address] AS [c_email_address] FROM [DemoDW].[tpcds].[customer] AS T3_1 INNER JOIN  (SELECT (((([T4_1].[ss_ext_list_price] - [T4_1].[ss_ext_wholesale_cost]) - [T4_1].[ss_ext_discount_amt]) + [T4_1].[ss_ext_sales_price]) / CAST ((2.) AS DECIMAL (1, 0))) AS [col], [T4_1].[ss_customer_sk] AS [ss_customer_sk], [T4_1].[ss_sold_date_sk] AS [ss_sold_date_sk] FROM [DemoDW].[tpcds].[store_sales] AS T4_1 WHERE (([T4_1].[ss_sold_date_sk] IS NOT NULL) AND ([T4_1].[ss_customer_sk] IS NOT NULL) AND ([T4_1].[ss_ext_discount_amt] IS NOT NULL) AND ([T4_1].[ss_ext_sales_price] IS NOT NULL) AND ([T4_1].[ss_ext_wholesale_cost] IS NOT NULL) AND ([T4_1].[ss_ext_list_price] IS NOT NULL))) AS T3_2  ON ([T3_1].[c_customer_sk] = [T3_2].[ss_customer_sk])) AS T2_2  ON ([T2_2].[ss_sold_date_sk] = [T2_1].[d_date_sk]) GROUP BY [T2_2].[c_customer_id], [T2_2].[c_first_name], [T2_2].[c_last_name], [T2_2].[c_preferred_cust_flag], [T2_2].[c_birth_country], [T2_2].[c_login], [T2_2].[c_email_address]) AS T1_1  OPTION (MAXDOP 2, MIN_GRANT_PERCENT = [MIN_GRANT], DISTRIBUTED_MOVE(N''))</source_statement>
            <destination_table>[TEMP_ID_158]</destination_table>
            <shuffle_columns>c_customer_id;</shuffle_columns>
        </dsql_operation>
        <dsql_operation operation_type="RND_ID">
            <identifier>TEMP_ID_159</identifier>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="AllDistributions" />
            <sql_operations>
                <sql_operation type="statement">CREATE TABLE [qtabledb].[dbo].[TEMP_ID_159] ([c_customer_id] CHAR(16) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL, [c_first_name] CHAR(20) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_last_name] CHAR(30) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_preferred_cust_flag] CHAR(1) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_birth_country] VARCHAR(20) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_login] CHAR(13) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_email_address] CHAR(50) COLLATE SQL_Latin1_General_CP1_CI_AS, [col] DECIMAL(38, 6) ) WITH(DISTRIBUTED_MOVE_FILE='');</sql_operation>
            </sql_operations>
        </dsql_operation>
        <dsql_operation operation_type="SHUFFLE_MOVE">
            <operation_cost cost="0.503725582372881" accumulative_cost="1.11652602711864" average_rowsize="159" output_rows="389.4105" GroupNumber="487" />
            <source_statement>SELECT [T1_1].[c_customer_id] AS [c_customer_id], [T1_1].[c_first_name] AS [c_first_name], [T1_1].[c_last_name] AS [c_last_name], [T1_1].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T1_1].[c_birth_country] AS [c_birth_country], [T1_1].[c_login] AS [c_login], [T1_1].[c_email_address] AS [c_email_address], [T1_1].[col] AS [col] FROM (SELECT SUM([T2_2].[col]) AS [col], [T2_2].[c_customer_id] AS [c_customer_id], [T2_2].[c_first_name] AS [c_first_name], [T2_2].[c_last_name] AS [c_last_name], [T2_2].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T2_2].[c_birth_country] AS [c_birth_country], [T2_2].[c_login] AS [c_login], [T2_2].[c_email_address] AS [c_email_address] FROM (SELECT [T3_1].[d_date_sk] AS [d_date_sk] FROM [DemoDW].[tpcds].[date_dim] AS T3_1 WHERE ([T3_1].[d_year] = CAST ((2001) AS INT))) AS T2_1 INNER JOIN  (SELECT [T3_2].[cs_sold_date_sk] AS [cs_sold_date_sk], [T3_2].[col] AS [col], [T3_1].[c_customer_id] AS [c_customer_id], [T3_1].[c_first_name] AS [c_first_name], [T3_1].[c_last_name] AS [c_last_name], [T3_1].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T3_1].[c_birth_country] AS [c_birth_country], [T3_1].[c_login] AS [c_login], [T3_1].[c_email_address] AS [c_email_address] FROM [DemoDW].[tpcds].[customer] AS T3_1 INNER JOIN  (SELECT (((([T4_1].[cs_ext_list_price] - [T4_1].[cs_ext_wholesale_cost]) - [T4_1].[cs_ext_discount_amt]) + [T4_1].[cs_ext_sales_price]) / CAST ((2.) AS DECIMAL (1, 0))) AS [col], [T4_1].[cs_bill_customer_sk] AS [cs_bill_customer_sk], [T4_1].[cs_sold_date_sk] AS [cs_sold_date_sk] FROM [DemoDW].[tpcds].[catalog_sales] AS T4_1 WHERE (([T4_1].[cs_sold_date_sk] IS NOT NULL) AND ([T4_1].[cs_bill_customer_sk] IS NOT NULL) AND ([T4_1].[cs_ext_discount_amt] IS NOT NULL) AND ([T4_1].[cs_ext_sales_price] IS NOT NULL) AND ([T4_1].[cs_ext_wholesale_cost] IS NOT NULL) AND ([T4_1].[cs_ext_list_price] IS NOT NULL))) AS T3_2  ON ([T3_1].[c_customer_sk] = [T3_2].[cs_bill_customer_sk])) AS T2_2  ON ([T2_2].[cs_sold_date_sk] = [T2_1].[d_date_sk]) GROUP BY [T2_2].[c_customer_id], [T2_2].[c_first_name], [T2_2].[c_last_name], [T2_2].[c_preferred_cust_flag], [T2_2].[c_birth_country], [T2_2].[c_login], [T2_2].[c_email_address]) AS T1_1  OPTION (MAXDOP 2, MIN_GRANT_PERCENT = [MIN_GRANT], DISTRIBUTED_MOVE(N''))</source_statement>
            <destination_table>[TEMP_ID_159]</destination_table>
            <shuffle_columns>c_customer_id;</shuffle_columns>
        </dsql_operation>
        <dsql_operation operation_type="RND_ID">
            <identifier>TEMP_ID_160</identifier>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="AllDistributions" />
            <sql_operations>
                <sql_operation type="statement">CREATE TABLE [qtabledb].[dbo].[TEMP_ID_160] ([c_customer_id] CHAR(16) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL, [c_first_name] CHAR(20) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_last_name] CHAR(30) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_preferred_cust_flag] CHAR(1) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_birth_country] VARCHAR(20) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_login] CHAR(13) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_email_address] CHAR(50) COLLATE SQL_Latin1_General_CP1_CI_AS, [col] DECIMAL(38, 6) ) WITH(DISTRIBUTED_MOVE_FILE='');</sql_operation>
            </sql_operations>
        </dsql_operation>
        <dsql_operation operation_type="SHUFFLE_MOVE">
            <operation_cost cost="0.503725582372881" accumulative_cost="1.62025160949153" average_rowsize="159" output_rows="389.4105" GroupNumber="495" />
            <source_statement>SELECT [T1_1].[c_customer_id] AS [c_customer_id], [T1_1].[c_first_name] AS [c_first_name], [T1_1].[c_last_name] AS [c_last_name], [T1_1].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T1_1].[c_birth_country] AS [c_birth_country], [T1_1].[c_login] AS [c_login], [T1_1].[c_email_address] AS [c_email_address], [T1_1].[col] AS [col] FROM (SELECT SUM([T2_2].[col]) AS [col], [T2_2].[c_customer_id] AS [c_customer_id], [T2_2].[c_first_name] AS [c_first_name], [T2_2].[c_last_name] AS [c_last_name], [T2_2].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T2_2].[c_birth_country] AS [c_birth_country], [T2_2].[c_login] AS [c_login], [T2_2].[c_email_address] AS [c_email_address] FROM (SELECT [T3_1].[d_date_sk] AS [d_date_sk] FROM [DemoDW].[tpcds].[date_dim] AS T3_1 WHERE ([T3_1].[d_year] = CAST ((2001) AS INT))) AS T2_1 INNER JOIN  (SELECT [T3_2].[ws_sold_date_sk] AS [ws_sold_date_sk], [T3_2].[col] AS [col], [T3_1].[c_customer_id] AS [c_customer_id], [T3_1].[c_first_name] AS [c_first_name], [T3_1].[c_last_name] AS [c_last_name], [T3_1].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T3_1].[c_birth_country] AS [c_birth_country], [T3_1].[c_login] AS [c_login], [T3_1].[c_email_address] AS [c_email_address] FROM [DemoDW].[tpcds].[customer] AS T3_1 INNER JOIN  (SELECT (((([T4_1].[ws_ext_list_price] - [T4_1].[ws_ext_wholesale_cost]) - [T4_1].[ws_ext_discount_amt]) + [T4_1].[ws_ext_sales_price]) / CAST ((2.) AS DECIMAL (1, 0))) AS [col], [T4_1].[ws_bill_customer_sk] AS [ws_bill_customer_sk], [T4_1].[ws_sold_date_sk] AS [ws_sold_date_sk] FROM [DemoDW].[tpcds].[web_sales] AS T4_1 WHERE (([T4_1].[ws_sold_date_sk] IS NOT NULL) AND ([T4_1].[ws_bill_customer_sk] IS NOT NULL) AND ([T4_1].[ws_ext_discount_amt] IS NOT NULL) AND ([T4_1].[ws_ext_sales_price] IS NOT NULL) AND ([T4_1].[ws_ext_wholesale_cost] IS NOT NULL) AND ([T4_1].[ws_ext_list_price] IS NOT NULL))) AS T3_2  ON ([T3_1].[c_customer_sk] = [T3_2].[ws_bill_customer_sk])) AS T2_2  ON ([T2_2].[ws_sold_date_sk] = [T2_1].[d_date_sk]) GROUP BY [T2_2].[c_customer_id], [T2_2].[c_first_name], [T2_2].[c_last_name], [T2_2].[c_preferred_cust_flag], [T2_2].[c_birth_country], [T2_2].[c_login], [T2_2].[c_email_address]) AS T1_1  OPTION (MAXDOP 2, MIN_GRANT_PERCENT = [MIN_GRANT], DISTRIBUTED_MOVE(N''))</source_statement>
            <destination_table>[TEMP_ID_160]</destination_table>
            <shuffle_columns>c_customer_id;</shuffle_columns>
        </dsql_operation>
        <dsql_operation operation_type="RND_ID">
            <identifier>TEMP_ID_161</identifier>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="AllDistributions" />
            <sql_operations>
                <sql_operation type="statement">CREATE TABLE [qtabledb].[dbo].[TEMP_ID_161] ([c_customer_id] CHAR(16) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL, [c_first_name] CHAR(20) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_last_name] CHAR(30) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_preferred_cust_flag] CHAR(1) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_birth_country] VARCHAR(20) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_login] CHAR(13) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_email_address] CHAR(50) COLLATE SQL_Latin1_General_CP1_CI_AS, [col] DECIMAL(38, 6) ) WITH(DISTRIBUTED_MOVE_FILE='');</sql_operation>
            </sql_operations>
        </dsql_operation>
        <dsql_operation operation_type="SHUFFLE_MOVE">
            <operation_cost cost="0.523864360677966" accumulative_cost="2.14411597016949" average_rowsize="159" output_rows="404.979" GroupNumber="455" />
            <source_statement>SELECT [T1_1].[c_customer_id] AS [c_customer_id], [T1_1].[c_first_name] AS [c_first_name], [T1_1].[c_last_name] AS [c_last_name], [T1_1].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T1_1].[c_birth_country] AS [c_birth_country], [T1_1].[c_login] AS [c_login], [T1_1].[c_email_address] AS [c_email_address], [T1_1].[col] AS [col] FROM (SELECT SUM([T2_2].[col]) AS [col], [T2_2].[c_customer_id] AS [c_customer_id], [T2_2].[c_first_name] AS [c_first_name], [T2_2].[c_last_name] AS [c_last_name], [T2_2].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T2_2].[c_birth_country] AS [c_birth_country], [T2_2].[c_login] AS [c_login], [T2_2].[c_email_address] AS [c_email_address] FROM (SELECT [T3_1].[d_date_sk] AS [d_date_sk] FROM [DemoDW].[tpcds].[date_dim] AS T3_1 WHERE ([T3_1].[d_year] = CAST ((2002) AS INT))) AS T2_1 INNER JOIN  (SELECT [T3_2].[ws_sold_date_sk] AS [ws_sold_date_sk], [T3_2].[col] AS [col], [T3_1].[c_customer_id] AS [c_customer_id], [T3_1].[c_first_name] AS [c_first_name], [T3_1].[c_last_name] AS [c_last_name], [T3_1].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T3_1].[c_birth_country] AS [c_birth_country], [T3_1].[c_login] AS [c_login], [T3_1].[c_email_address] AS [c_email_address] FROM [DemoDW].[tpcds].[customer] AS T3_1 INNER JOIN  (SELECT (((([T4_1].[ws_ext_list_price] - [T4_1].[ws_ext_wholesale_cost]) - [T4_1].[ws_ext_discount_amt]) + [T4_1].[ws_ext_sales_price]) / CAST ((2.) AS DECIMAL (1, 0))) AS [col], [T4_1].[ws_bill_customer_sk] AS [ws_bill_customer_sk], [T4_1].[ws_sold_date_sk] AS [ws_sold_date_sk] FROM [DemoDW].[tpcds].[web_sales] AS T4_1 WHERE (([T4_1].[ws_sold_date_sk] IS NOT NULL) AND ([T4_1].[ws_bill_customer_sk] IS NOT NULL))) AS T3_2  ON ([T3_1].[c_customer_sk] = [T3_2].[ws_bill_customer_sk])) AS T2_2  ON ([T2_2].[ws_sold_date_sk] = [T2_1].[d_date_sk]) GROUP BY [T2_2].[c_customer_id], [T2_2].[c_first_name], [T2_2].[c_last_name], [T2_2].[c_preferred_cust_flag], [T2_2].[c_birth_country], [T2_2].[c_login], [T2_2].[c_email_address]) AS T1_1  OPTION (MAXDOP 2, MIN_GRANT_PERCENT = [MIN_GRANT], DISTRIBUTED_MOVE(N''))</source_statement>
            <destination_table>[TEMP_ID_161]</destination_table>
            <shuffle_columns>c_customer_id;</shuffle_columns>
        </dsql_operation>
        <dsql_operation operation_type="RND_ID">
            <identifier>TEMP_ID_162</identifier>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="AllDistributions" />
            <sql_operations>
                <sql_operation type="statement">CREATE TABLE [qtabledb].[dbo].[TEMP_ID_162] ([c_customer_id] CHAR(16) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL, [c_first_name] CHAR(20) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_last_name] CHAR(30) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_preferred_cust_flag] CHAR(1) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_birth_country] VARCHAR(20) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_login] CHAR(13) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_email_address] CHAR(50) COLLATE SQL_Latin1_General_CP1_CI_AS, [col] DECIMAL(38, 6) ) WITH(DISTRIBUTED_MOVE_FILE='');</sql_operation>
            </sql_operations>
        </dsql_operation>
        <dsql_operation operation_type="SHUFFLE_MOVE">
            <operation_cost cost="0.612800444745763" accumulative_cost="2.75691641491525" average_rowsize="159" output_rows="473.732" GroupNumber="471" />
            <source_statement>SELECT [T1_1].[c_customer_id] AS [c_customer_id], [T1_1].[c_first_name] AS [c_first_name], [T1_1].[c_last_name] AS [c_last_name], [T1_1].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T1_1].[c_birth_country] AS [c_birth_country], [T1_1].[c_login] AS [c_login], [T1_1].[c_email_address] AS [c_email_address], [T1_1].[col] AS [col] FROM (SELECT SUM([T2_2].[col]) AS [col], [T2_2].[c_customer_id] AS [c_customer_id], [T2_2].[c_first_name] AS [c_first_name], [T2_2].[c_last_name] AS [c_last_name], [T2_2].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T2_2].[c_birth_country] AS [c_birth_country], [T2_2].[c_login] AS [c_login], [T2_2].[c_email_address] AS [c_email_address] FROM (SELECT [T3_1].[d_date_sk] AS [d_date_sk] FROM [DemoDW].[tpcds].[date_dim] AS T3_1 WHERE ([T3_1].[d_year] = CAST ((2002) AS INT))) AS T2_1 INNER JOIN  (SELECT [T3_2].[ss_sold_date_sk] AS [ss_sold_date_sk], [T3_2].[col] AS [col], [T3_1].[c_customer_id] AS [c_customer_id], [T3_1].[c_first_name] AS [c_first_name], [T3_1].[c_last_name] AS [c_last_name], [T3_1].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T3_1].[c_birth_country] AS [c_birth_country], [T3_1].[c_login] AS [c_login], [T3_1].[c_email_address] AS [c_email_address] FROM [DemoDW].[tpcds].[customer] AS T3_1 INNER JOIN  (SELECT (((([T4_1].[ss_ext_list_price] - [T4_1].[ss_ext_wholesale_cost]) - [T4_1].[ss_ext_discount_amt]) + [T4_1].[ss_ext_sales_price]) / CAST ((2.) AS DECIMAL (1, 0))) AS [col], [T4_1].[ss_customer_sk] AS [ss_customer_sk], [T4_1].[ss_sold_date_sk] AS [ss_sold_date_sk] FROM [DemoDW].[tpcds].[store_sales] AS T4_1 WHERE (([T4_1].[ss_sold_date_sk] IS NOT NULL) AND ([T4_1].[ss_customer_sk] IS NOT NULL))) AS T3_2  ON ([T3_1].[c_customer_sk] = [T3_2].[ss_customer_sk])) AS T2_2  ON ([T2_2].[ss_sold_date_sk] = [T2_1].[d_date_sk]) GROUP BY [T2_2].[c_customer_id], [T2_2].[c_first_name], [T2_2].[c_last_name], [T2_2].[c_preferred_cust_flag], [T2_2].[c_birth_country], [T2_2].[c_login], [T2_2].[c_email_address]) AS T1_1  OPTION (MAXDOP 2, MIN_GRANT_PERCENT = [MIN_GRANT], DISTRIBUTED_MOVE(N''))</source_statement>
            <destination_table>[TEMP_ID_162]</destination_table>
            <shuffle_columns>c_customer_id;</shuffle_columns>
        </dsql_operation>
        <dsql_operation operation_type="RND_ID">
            <identifier>TEMP_ID_163</identifier>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="AllDistributions" />
            <sql_operations>
                <sql_operation type="statement">CREATE TABLE [qtabledb].[dbo].[TEMP_ID_163] ([c_customer_id] CHAR(16) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL, [c_first_name] CHAR(20) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_last_name] CHAR(30) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_preferred_cust_flag] CHAR(1) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_birth_country] VARCHAR(20) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_login] CHAR(13) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_email_address] CHAR(50) COLLATE SQL_Latin1_General_CP1_CI_AS, [col] DECIMAL(38, 6) ) WITH(DISTRIBUTED_MOVE_FILE='');</sql_operation>
            </sql_operations>
        </dsql_operation>
        <dsql_operation operation_type="SHUFFLE_MOVE">
            <operation_cost cost="0.523864360677966" accumulative_cost="3.28078077559322" average_rowsize="159" output_rows="404.979" GroupNumber="463" />
            <source_statement>SELECT [T1_1].[c_customer_id] AS [c_customer_id], [T1_1].[c_first_name] AS [c_first_name], [T1_1].[c_last_name] AS [c_last_name], [T1_1].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T1_1].[c_birth_country] AS [c_birth_country], [T1_1].[c_login] AS [c_login], [T1_1].[c_email_address] AS [c_email_address], [T1_1].[col] AS [col] FROM (SELECT SUM([T2_2].[col]) AS [col], [T2_2].[c_customer_id] AS [c_customer_id], [T2_2].[c_first_name] AS [c_first_name], [T2_2].[c_last_name] AS [c_last_name], [T2_2].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T2_2].[c_birth_country] AS [c_birth_country], [T2_2].[c_login] AS [c_login], [T2_2].[c_email_address] AS [c_email_address] FROM (SELECT [T3_1].[d_date_sk] AS [d_date_sk] FROM [DemoDW].[tpcds].[date_dim] AS T3_1 WHERE ([T3_1].[d_year] = CAST ((2002) AS INT))) AS T2_1 INNER JOIN  (SELECT [T3_2].[cs_sold_date_sk] AS [cs_sold_date_sk], [T3_2].[col] AS [col], [T3_1].[c_customer_id] AS [c_customer_id], [T3_1].[c_first_name] AS [c_first_name], [T3_1].[c_last_name] AS [c_last_name], [T3_1].[c_preferred_cust_flag] AS [c_preferred_cust_flag], [T3_1].[c_birth_country] AS [c_birth_country], [T3_1].[c_login] AS [c_login], [T3_1].[c_email_address] AS [c_email_address] FROM [DemoDW].[tpcds].[customer] AS T3_1 INNER JOIN  (SELECT (((([T4_1].[cs_ext_list_price] - [T4_1].[cs_ext_wholesale_cost]) - [T4_1].[cs_ext_discount_amt]) + [T4_1].[cs_ext_sales_price]) / CAST ((2.) AS DECIMAL (1, 0))) AS [col], [T4_1].[cs_bill_customer_sk] AS [cs_bill_customer_sk], [T4_1].[cs_sold_date_sk] AS [cs_sold_date_sk] FROM [DemoDW].[tpcds].[catalog_sales] AS T4_1 WHERE (([T4_1].[cs_sold_date_sk] IS NOT NULL) AND ([T4_1].[cs_bill_customer_sk] IS NOT NULL))) AS T3_2  ON ([T3_1].[c_customer_sk] = [T3_2].[cs_bill_customer_sk])) AS T2_2  ON ([T2_2].[cs_sold_date_sk] = [T2_1].[d_date_sk]) GROUP BY [T2_2].[c_customer_id], [T2_2].[c_first_name], [T2_2].[c_last_name], [T2_2].[c_preferred_cust_flag], [T2_2].[c_birth_country], [T2_2].[c_login], [T2_2].[c_email_address]) AS T1_1  OPTION (MAXDOP 2, MIN_GRANT_PERCENT = [MIN_GRANT], DISTRIBUTED_MOVE(N''))</source_statement>
            <destination_table>[TEMP_ID_163]</destination_table>
            <shuffle_columns>c_customer_id;</shuffle_columns>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="Control" />
            <sql_operations>
                <sql_operation type="statement">CREATE TABLE [tempdb].[QTables].[QTable_384efe2e021d4e59befd84ee541b5730] ([col] DECIMAL(38, 6) NOT NULL, [col1] DECIMAL(38, 6), [c_customer_id] CHAR(16) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL, [c_first_name] CHAR(20) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_last_name] CHAR(30) COLLATE SQL_Latin1_General_CP1_CI_AS, [c_email_address] CHAR(50) COLLATE SQL_Latin1_General_CP1_CI_AS, [col2] DECIMAL(38, 6) NOT NULL, [col3] DECIMAL(38, 6), [col4] DECIMAL(38, 6) NOT NULL, [col5] DECIMAL(38, 6) ) WITH(DISTRIBUTED_MOVE_FILE='');</sql_operation>
            </sql_operations>
        </dsql_operation>
        <dsql_operation operation_type="PARTITION_MOVE">
            <operation_cost cost="2.35079808" accumulative_cost="5.63157885559322" average_rowsize="170" output_rows="57.6176" GroupNumber="512" />
            <location distribution="AllDistributions" />
            <source_statement>SELECT [T1_1].[col] AS [col], [T1_1].[col1] AS [col1], [T1_1].[c_customer_id] AS [c_customer_id], [T1_1].[c_first_name] AS [c_first_name], [T1_1].[c_last_name] AS [c_last_name], [T1_1].[c_email_address] AS [c_email_address], [T1_1].[col2] AS [col2], [T1_1].[col3] AS [col3], [T1_1].[col4] AS [col4], [T1_1].[col5] AS [col5] FROM (SELECT TOP (CAST ((100) AS BIGINT)) [T2_1].[col] AS [col], [T2_2].[col2] AS [col1], [T2_2].[c_customer_id3] AS [c_customer_id], [T2_2].[c_first_name] AS [c_first_name], [T2_2].[c_last_name] AS [c_last_name], [T2_2].[c_email_address] AS [c_email_address], [T2_2].[col1] AS [col2], [T2_2].[col] AS [col3], [T2_2].[col4] AS [col4], [T2_2].[col5] AS [col5] FROM (SELECT [T3_1].[c_customer_id] AS [c_customer_id], [T3_1].[col] AS [col] FROM (SELECT SUM([T4_1].[col]) AS [col], [T4_1].[c_customer_id] AS [c_customer_id] FROM [qtabledb].[dbo].[TEMP_ID_158] AS T4_1 GROUP BY [T4_1].[c_customer_id], [T4_1].[c_first_name], [T4_1].[c_last_name], [T4_1].[c_preferred_cust_flag], [T4_1].[c_birth_country], [T4_1].[c_login], [T4_1].[c_email_address]) AS T3_1 WHERE ([T3_1].[col] &gt; CAST ((0.000000) AS DECIMAL (38, 6)))) AS T2_1 INNER JOIN  (SELECT [T3_2].[c_customer_id] AS [c_customer_id], [T3_2].[col] AS [col], [T3_1].[col] AS [col1], [T3_2].[col3] AS [col2], [T3_2].[c_customer_id4] AS [c_customer_id3], [T3_2].[c_first_name] AS [c_first_name], [T3_2].[c_last_name] AS [c_last_name], [T3_2].[c_email_address] AS [c_email_address], [T3_2].[col2] AS [col4], [T3_2].[col1] AS [col5] FROM (SELECT [T4_1].[c_customer_id] AS [c_customer_id], [T4_1].[col] AS [col] FROM (SELECT SUM([T5_1].[col]) AS [col], [T5_1].[c_customer_id] AS [c_customer_id] FROM [qtabledb].[dbo].[TEMP_ID_159] AS T5_1 GROUP BY [T5_1].[c_customer_id], [T5_1].[c_first_name], [T5_1].[c_last_name], [T5_1].[c_preferred_cust_flag], [T5_1].[c_birth_country], [T5_1].[c_login], [T5_1].[c_email_address]) AS T4_1 WHERE ([T4_1].[col] &gt; CAST ((0.000000) AS DECIMAL (38, 6)))) AS T3_1 INNER JOIN  (SELECT [T4_2].[c_customer_id] AS [c_customer_id], [T4_2].[col] AS [col], [T4_2].[col1] AS [col1], [T4_1].[col] AS [col2], [T4_2].[col2] AS [col3], [T4_2].[c_customer_id3] AS [c_customer_id4], [T4_2].[c_first_name] AS [c_first_name], [T4_2].[c_last_name] AS [c_last_name], [T4_2].[c_email_address] AS [c_email_address] FROM (SELECT [T5_1].[c_customer_id] AS [c_customer_id], [T5_1].[col] AS [col] FROM (SELECT SUM([T6_1].[col]) AS [col], [T6_1].[c_customer_id] AS [c_customer_id] FROM [qtabledb].[dbo].[TEMP_ID_160] AS T6_1 GROUP BY [T6_1].[c_customer_id], [T6_1].[c_first_name], [T6_1].[c_last_name], [T6_1].[c_preferred_cust_flag], [T6_1].[c_birth_country], [T6_1].[c_login], [T6_1].[c_email_address]) AS T5_1 WHERE ([T5_1].[col] &gt; CAST ((0.000000) AS DECIMAL (38, 6)))) AS T4_1 INNER JOIN  (SELECT [T5_1].[c_customer_id] AS [c_customer_id], [T5_2].[col] AS [col], [T5_1].[col] AS [col1], [T5_2].[col1] AS [col2], [T5_2].[c_customer_id2] AS [c_customer_id3], [T5_2].[c_first_name] AS [c_first_name], [T5_2].[c_last_name] AS [c_last_name], [T5_2].[c_email_address] AS [c_email_address] FROM (SELECT SUM([T6_1].[col]) AS [col], [T6_1].[c_customer_id] AS [c_customer_id] FROM [qtabledb].[dbo].[TEMP_ID_161] AS T6_1 GROUP BY [T6_1].[c_customer_id], [T6_1].[c_first_name], [T6_1].[c_last_name], [T6_1].[c_preferred_cust_flag], [T6_1].[c_birth_country], [T6_1].[c_login], [T6_1].[c_email_address]) AS T5_1 INNER JOIN  (SELECT [T6_2].[c_customer_id] AS [c_customer_id], [T6_2].[col] AS [col], [T6_1].[col] AS [col1], [T6_1].[c_customer_id] AS [c_customer_id2], [T6_1].[c_first_name] AS [c_first_name], [T6_1].[c_last_name] AS [c_last_name], [T6_1].[c_email_address] AS [c_email_address] FROM (SELECT SUM([T7_1].[col]) AS [col], [T7_1].[c_customer_id] AS [c_customer_id], [T7_1].[c_first_name] AS [c_first_name], [T7_1].[c_last_name] AS [c_last_name], [T7_1].[c_email_address] AS [c_email_address], [T7_1].[c_customer_id] AS [c_customer_id1] FROM [qtabledb].[dbo].[TEMP_ID_162] AS T7_1 GROUP BY [T7_1].[c_customer_id], [T7_1].[c_first_name], [T7_1].[c_last_name], [T7_1].[c_preferred_cust_flag], [T7_1].[c_birth_country], [T7_1].[c_login], [T7_1].[c_email_address]) AS T6_1 INNER JOIN  (SELECT SUM([T7_1].[col]) AS [col], [T7_1].[c_customer_id] AS [c_customer_id] FROM [qtabledb].[dbo].[TEMP_ID_163] AS T7_1 GROUP BY [T7_1].[c_customer_id], [T7_1].[c_first_name], [T7_1].[c_last_name], [T7_1].[c_preferred_cust_flag], [T7_1].[c_birth_country], [T7_1].[c_login], [T7_1].[c_email_address]) AS T6_2  ON ([T6_1].[c_customer_id1] = [T6_2].[c_customer_id])) AS T5_2  ON ([T5_2].[c_customer_id] = [T5_1].[c_customer_id])) AS T4_2  ON ([T4_1].[c_customer_id] = [T4_2].[c_customer_id])) AS T3_2  ON (([T3_1].[c_customer_id] = [T3_2].[c_customer_id]) AND (CASE   WHEN ([T3_1].[col] &gt; CAST ((0.000000) AS DECIMAL (38, 6))) THEN ([T3_2].[col] / [T3_1].[col])   ELSE CAST (NULL AS DECIMAL (38, 6))  END &gt; CASE   WHEN ([T3_2].[col2] &gt; CAST ((0.000000) AS DECIMAL (38, 6))) THEN ([T3_2].[col1] / [T3_2].[col2])   ELSE CAST (NULL AS DECIMAL (38, 6))  END))) AS T2_2  ON (([T2_1].[c_customer_id] = [T2_2].[c_customer_id]) AND (CASE   WHEN ([T2_2].[col1] &gt; CAST ((0.000000) AS DECIMAL (38, 6))) THEN ([T2_2].[col] / [T2_2].[col1])   ELSE CAST (NULL AS DECIMAL (38, 6))  END &gt; CASE   WHEN ([T2_1].[col] &gt; CAST ((0.000000) AS DECIMAL (38, 6))) THEN ([T2_2].[col2] / [T2_1].[col])   ELSE CAST (NULL AS DECIMAL (38, 6))  END)) ORDER BY [T2_2].[c_customer_id3] ASC, [T2_2].[c_first_name] ASC, [T2_2].[c_last_name] ASC, [T2_2].[c_email_address] ASC) AS T1_1  OPTION (MAXDOP 2, MIN_GRANT_PERCENT = [MIN_GRANT], DISTRIBUTED_MOVE(N''))</source_statement>
            <destination>Control</destination>
            <destination_table>[QTable_384efe2e021d4e59befd84ee541b5730]</destination_table>
        </dsql_operation>
        <dsql_operation operation_type="RETURN">
            <location distribution="Control" />
            <select>SELECT [T1_1].[c_customer_id] AS [c_customer_id], [T1_1].[c_first_name] AS [c_first_name], [T1_1].[c_last_name] AS [c_last_name], [T1_1].[c_email_address] AS [c_email_address] FROM (SELECT TOP (CAST ((100) AS BIGINT)) [T2_1].[c_customer_id] AS [c_customer_id], [T2_1].[c_first_name] AS [c_first_name], [T2_1].[c_last_name] AS [c_last_name], [T2_1].[c_email_address] AS [c_email_address] FROM [tempdb].[QTables].[QTable_384efe2e021d4e59befd84ee541b5730] AS T2_1 ORDER BY [T2_1].[c_customer_id] ASC, [T2_1].[c_first_name] ASC, [T2_1].[c_last_name] ASC, [T2_1].[c_email_address] ASC) AS T1_1 ORDER BY [T1_1].[c_customer_id] ASC, [T1_1].[c_first_name] ASC, [T1_1].[c_last_name] ASC, [T1_1].[c_email_address] ASC  OPTION (MAXDOP 2, MIN_GRANT_PERCENT = [MIN_GRANT])</select>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="Control" />
            <sql_operations>
                <sql_operation type="statement">DROP TABLE [tempdb].[QTables].[QTable_384efe2e021d4e59befd84ee541b5730]</sql_operation>
            </sql_operations>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="AllDistributions" />
            <sql_operations>
                <sql_operation type="statement">DROP TABLE [qtabledb].[dbo].[TEMP_ID_163]</sql_operation>
            </sql_operations>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="AllDistributions" />
            <sql_operations>
                <sql_operation type="statement">DROP TABLE [qtabledb].[dbo].[TEMP_ID_162]</sql_operation>
            </sql_operations>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="AllDistributions" />
            <sql_operations>
                <sql_operation type="statement">DROP TABLE [qtabledb].[dbo].[TEMP_ID_161]</sql_operation>
            </sql_operations>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="AllDistributions" />
            <sql_operations>
                <sql_operation type="statement">DROP TABLE [qtabledb].[dbo].[TEMP_ID_160]</sql_operation>
            </sql_operations>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="AllDistributions" />
            <sql_operations>
                <sql_operation type="statement">DROP TABLE [qtabledb].[dbo].[TEMP_ID_159]</sql_operation>
            </sql_operations>
        </dsql_operation>
        <dsql_operation operation_type="ON">
            <location permanent="false" distribution="AllDistributions" />
            <sql_operations>
                <sql_operation type="statement">DROP TABLE [qtabledb].[dbo].[TEMP_ID_158]</sql_operation>
            </sql_operations>
        </dsql_operation>
    </dsql_operations>
</dsql_query>